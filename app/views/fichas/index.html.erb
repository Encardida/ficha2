<%- model_class = Ficha -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
</div>
<table class="table table-striped">
  <thead>
    <tr>
      <% if (user_signed_in? && !current_user.teacher?) or !user_signed_in? %>
        <th><%= t('teacher') %></th>
      <% end %>

      <th><%= t('matter') %></th>

      <th width="15%"><center><%= t('created_at') %></center></th>

      <% if user_signed_in?%>
        <th><center><%= t('status') %></center></th>
      <% end %>

      <% if user_signed_in? && !current_user.appraiser? %>

        <th  width="25%">
          <%=t '.actions', :default => t("helpers.actions") %>
          <div style=float:right;>
            <%= link_to '+', new_ficha_path, :class => 'btn btn-primary btn-xs' %>
          <div>
        </th>

      <% elsif user_signed_in? %>
        <th  width="10%">
          <%=t '.actions', :default => t("helpers.actions") %>
        </th>
      <% else %>
        <th  width="10%"> <center>
          <%=t '.actions', :default => t("helpers.actions") %>
        </center> </th>
      <% end %>

    </tr>
  </thead>
  <tbody>
    <% @fichas.each do |ficha| %>
      <tr>
        <% if (user_signed_in? && !current_user.teacher?) or !user_signed_in?%>
          <td><%= ficha.user.name %></td>
        <% end %>
        <td><%= ficha.matter.name %></td>
        <td><center><%= ficha.created_at.strftime("%d/%m/%Y") %></center></td>

        <% if user_signed_in?%>
          <td><center><%= link_to status_representation(ficha.status), ficha_path(ficha) %></center></td>
        <% end %>

        <% if user_signed_in? && !current_user.appraiser? %>
          <td>
            <%= link_to t('Download'), ficha_path(ficha, format:"pdf"), :class => 'btn btn-default btn-xs' %>

            <%= link_to t('.edit', :default => t("helpers.links.edit")),
                        edit_ficha_path(ficha), :class => 'btn btn-default btn-xs' %>
              <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                          ficha_path(ficha),
                          :method => :delete,
                          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                          :class => 'btn btn-xs btn-danger' %>



          </td>

        <% elsif user_signed_in? && ficha.status != "Aprovado" %>
          <td>
            <%= link_to t('.edit', :default => t("helpers.links.edit")),
                        edit_ficha_path(ficha), :class => 'btn btn-default btn-xs' %>
          </td>
        <% elsif user_signed_in? %>
          <td></td>
        <% else %>
          <td> <center>
            <%= link_to t('Download'), ficha_path(ficha, format:"pdf"), :class => 'btn btn-default btn-xs' %>
          </center> </td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>
